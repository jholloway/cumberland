<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Cumberland</title>

		<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üåä</text></svg>">

		<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Droid+Sans+Mono" rel="stylesheet">

		<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

		<link href="jquery.highlight-within-textarea.css" rel="stylesheet">
		<script src="jquery.highlight-within-textarea.js"></script>

		<style>
			/* Highlight box styles */

			.hwt-container {
				background-color: #f8f9fa;
				width: 100%;
			}

			.hwt-content {
				width: 100%;
				height: 1800px;
				padding: 20px;
				border: 1px solid #adb5bd;
				color: inherit;
				font: 18px/25px 'Droid Sans Mono', sans-serif;
			}

			.hwt-content mark.red {
				background-color: #ffc9c9;
			}

			.hwt-content mark.blue {
				background-color: #a3daff;
			}

			.hwt-content mark.orange {
				background-color: #ffd8a8;
			}

			.hwt-content mark.purple {
				background-color: #e5d0ff;
			}

			/* General styles */

			* {
				box-sizing: border-box;
			}

			body {
				max-width: 1200px;
				margin: 40px auto;
				padding: 0 20px;
				font: 18px/1.4 'Open Sans', sans-serif;
				color: #495057;
				background-color: #f1f3f5;
			}

			section {
				margin-top: 60px;
			}

			/* Button styles */

			.button {
				margin-right: 10px;
				margin-bottom: 10px;
				padding: 10px 20px;
				font-size: 16px;
				cursor: pointer;
				background-color: #4CAF50;
				color: white;
				border: none;
				border-radius: 5px;
				transition: background-color 0.3s;
			}

			.button:hover {
				background-color: #45a049;
			}

			/* Input field styles */

			#quickTextInput {
				width: 100%;
				margin-top: 10px;
				padding: 5px;
				font-size: 16px;
				box-sizing: border-box;
			}
		</style>
	</head>
	<body>
		<section>
		<h1>üåä Cumberland</h1>
		<p>This is a simple copyediting tool. Paste text below and errors will be highlighted according to rules. Updates will occur in realtime.</p>

			<button id="clearButton" class="button">‚ùå Clear Text</button>
			<button id="resetButton" class="button">üîÑ Reset Example Text</button>
			<button id="copyButton" class="button">üìã Copy Text to Clipboard</button>
			
			<textarea class="highlightBox">
====================
Level 0 | Plain text
====================

Any text pasted into this box will be stripped of formatting and is now plain text. Use the button above to copy text to the clipboard.

===========================
Level 1 | Must be corrected
===========================

Phone numbers formatted like 123-456-7890 are correct. (123) 456-7890 will be highlighted. 123.456.7890 will be highlighted.

Dates formatted like August 31 are correct. Oct. 31 will be highlighted. Sept 15th will be highlighted. June 7th will be highlighted.

Times formatted like 11:30 a.m. are correct. 8:00 AM will be highlighted. 9:20pm will be highlighted. 7:15 pm will be highlighted.

Any & character will be highlighted. & & &

Any # character will be highlighted. # # #

Any "no." abbreviation followed by a number will be highlighted. no. 1 will be highlighted. no. 123 will be highlighted.

Any "click here" phrase will be highlighted. click here will be highlighted. Click Here will be highlighted.

=============================
Level 2 | Recommended changes
=============================

Any double  spaces   or greater will    be     highlighted.

Lines beginning with a bullet point and following spaces up to a letter will be highlighted.
‚Ä¢ Bullet point with spaces
‚Ä¢     Bullet point with several spaces
‚Ä¢Another bullet without space

URLs like https://www.example.com will be highlighted. http://subdomain.example.co.uk/page?param=value will be highlighted.

Street abbreviations like Rd, Ave, St, Pk, Pkwy, Blvd will be highlighted. Avenue should not be highlighted.

==============================
Level 3 | Optional corrections
==============================

Trailing space characters at the end of lines should be highlighted. 

‚ÄúCurly quotes‚Äù and ‚ÄòSingle curly quotes‚Äô but not 'straight' "quotes" will be highlighted. (Smart quotes from Microsoft apps can sometimes be incorrect and it's safer to convert them to straight quotes.)

================================
Level 4 | Requires manual review
================================

Any acronyms should match. NASA mission should match. FBI and CIA should match.
Words in ALL CAPS will also MATCH according to the acronym rule.
</textarea>
			
			<!-- Text manipulation tool -->

			<div style="margin-top: 20px;">
				<h2>Quick Text Manipulations</h2>
				<button id="lowercaseButton" class="button">üîΩ lowercase</button>
				<button id="titleCaseButton" class="button">üîº Title Case</button>
				<button id="removeSpacesButton" class="button">üëæ Remove Extra Spaces</button>
				<button id="removeBulletsButton" class="button">üî´ Remove Bullets</button>
				<br>
				<input type="text" id="quickTextInput" style="width: 100%; margin-top: 10px;" placeholder="Paste text here then use the buttons above to manipulate it">
				
				<!-- Character count display -->

				<div id="charCountDisplay" style="margin-top: 5px; font-size: 14px; color: #666;">Characters: 0</div>
			</div>

			<script>

				// Store the initial content

				const initialContent = document.querySelector('.highlightBox').value;

				// Clear button functionality

				document.getElementById('clearButton').addEventListener('click', function() {
					document.querySelector('.highlightBox').value = '';
					$('.highlightBox').trigger('input'); // Trigger highlighting
				});

				// Reset button functionality

				document.getElementById('resetButton').addEventListener('click', function() {
					document.querySelector('.highlightBox').value = initialContent;
					$('.highlightBox').trigger('input'); // Trigger highlighting
				});

				// Copy button functionality

				document.getElementById('copyButton').addEventListener('click', function() {
					var textarea = document.querySelector('.highlightBox');
					textarea.select();
					navigator.clipboard.writeText(textarea.value)
						.then(() => {
							this.textContent = 'Copied!';
							setTimeout(() => {
								this.textContent = 'Copy to Clipboard';
							}, 2000);
						})
						.catch(err => {
							console.error('Failed to copy text: ', err);
							this.textContent = 'Copy Failed';
							setTimeout(() => {
								this.textContent = 'Copy to Clipboard';
							}, 2000);
						});
				});

				// Highlighting rules

				$('.highlightBox').highlightWithinTextarea({
					highlight: [
						// Phone numbers
						{
							highlight: /(\()?\d{3}((\))|(\.)|\s)?\s*\d{3}(\.|-)?\s*\d{4}(?!-)/g,
							className: 'red'
						},
						// Dates
						{
							highlight: /\b(?!(January|February|March|April|May|June|July|August|September|October|November|December)\s\d{1,2}(,\s\d{4})?\b)((Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Sept|Oct|Nov|Dec|January|February|March|April|June|July|August|September|October|November|December)\.?\s\d{1,2}(?:st|nd|rd|th)?(?!,\s\d{4}))(?!\s*[ap]\.m\.)\b/gi,
							className: 'red'
						},
						// Ampersand
						{
							highlight: /&/g,
							className: 'red'
						},
						// Hash
						{
							highlight: /#/g,
							className: 'red'
						},
						// No.
						{
							highlight: /\bno\.\s*\d+\b/gi,
							className: 'red'
						},
						// Click here
						{
							highlight: /\b(?:1[0-2]|0?[1-9]):[0-5][0-9](?:\s*(?:AM|PM|A\.M\.|P\.M\.)|[ap]\.?m\.?(?!\.)|\s+[ap]m|\s+[AP]M)\b/g,
							className: 'red'
						},
						// Click here
						{
							highlight: /\bclick here\b/gi,
							className: 'red'
						},
						// Extra spaces
						{
							highlight: /[^\S\r\n]{2,}(?!$)/gm,
							className: 'orange'
						},
						// Bullets
						{
							highlight: /^[‚Ä¢]\s*/gm,
							className: 'orange'
						},
						// URLs
						{
							highlight: /https?:\/\/(?:www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b(?:[-a-zA-Z0-9()@:%_\+.~#?&//=]*)/g,
							className: 'orange'
						},
						// Trailing spaces
						{
							highlight: /[ \t]+$/gm,
							className: 'blue'
						},
						// Curly quotes
						{
							highlight: /[‚Äú‚Äù‚Äò‚Äô]/g,
							className: 'blue'
						},
						// Acronyms
						{
							highlight: /\b[A-Z]{2,}\b/g,
							className: 'purple'
						},
						// Times
						{
							highlight: /\b(?!\d{1,2}(:\d{2})? [ap]\.m\.)\d{1,2}(:\d{2})?\s*[ap]\.?m?\.?\b/gi,
							className: 'red'
						},
						
						// Street abbreviations
						{
							highlight: /\b(Rd|Ave|St|Pk|Pkwy|Blvd|Wy|Ct|Dr|Cir|Ctr|Hwy|Ln|Pl|Rte|Sq|Ter|Ft|Sq)\.?\b/g,
							className: 'orange'
						}
					]
				});

				// Character count update function

				function updateCharCount() {
					var input = document.getElementById('quickTextInput');
					var charCount = input.value.length;
					document.getElementById('charCountDisplay').textContent = 'Characters: ' + charCount;
				}

				// Add event listener for real-time updates

				document.getElementById('quickTextInput').addEventListener('input', updateCharCount);

				// Script for text manipulations on the input field

				document.querySelectorAll('.button').forEach(button => {
					button.addEventListener('click', function() {
						var input = document.getElementById('quickTextInput');
						switch(this.id) {
							case 'lowercaseButton':
								input.value = input.value.toLowerCase();
								break;
							case 'titleCaseButton':
								input.value = toTitleCase(input.value);
								break;
							case 'removeSpacesButton':
								input.value = input.value.replace(/\s+/g, ' ').trim();
								break;
							case 'removeBulletsButton':
								input.value = input.value.replace(/^[‚Ä¢\-\*\s]+/, '').trim();
								break;
						}
						updateCharCount(); // Update character count after manipulation
					});
				});

				// Title Case function

				function toTitleCase(str) {
					var smallWords = /^(a|an|and|as|at|but|by|en|for|if|in|of|on|or|the|to|vs?\.?|via)$/i;

					return str.replace(/[A-Za-z0-9\u00C0-\u00FF]+[^\s-]*/g, function(match, index, title) {
						if (index > 0 && index + match.length !== title.length &&
							match.search(smallWords) > -1 && title.charAt(index - 2) !== ":" &&
							(title.charAt(index + match.length) !== '-' || title.charAt(index - 1) === '-') &&
							title.charAt(index - 1).search(/[^\s-]/) < 0) {
							return match.toLowerCase();
						}

						if (match.substr(1).search(/[A-Z]|\../) > -1) {
							return match;
						}

						return match.charAt(0).toUpperCase() + match.substr(1);
					});
				}
			</script>
		</section>

	</body>
</html>