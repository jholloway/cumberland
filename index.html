<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Cumberland</title>

		<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üåä</text></svg>">

		<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Droid+Sans+Mono" rel="stylesheet">

		<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
		<!-- Removed: <script src="https://cdn.jsdelivr.net/npm/title-case@3.0.3/dist/index.umd.min.js"></script> -->

		<!-- highlight-within-textarea CSS/JS -->
		<link href="jquery.highlight-within-textarea.css" rel="stylesheet">
		<script src="jquery.highlight-within-textarea.js"></script>

		<style>
			.hwt-container {
				background-color: #f8f9fa;
				width: 100%;
			}

			.hwt-content {
				width: 100%;
				height: 1200px;
				padding: 20px;
				border: 1px solid #adb5bd;
				color: inherit;
				font: 18px/25px 'Droid Sans Mono', sans-serif;
			}

			.hwt-content mark.red {
				background-color: #ffc9c9;
			}

			.hwt-content mark.blue {
				background-color: #a3daff;
			}

			.hwt-content mark.orange {
				background-color: #ffd8a8;
			}

			.hwt-content mark.purple {
				background-color: #e5d0ff;
			}

			* {
				box-sizing: border-box;
			}

			body {
				max-width: 1200px;
				margin: 40px auto;
				padding: 0 20px;
				font: 18px/1.4 'Open Sans', sans-serif;
				color: #495057;
				background-color: #f1f3f5;
			}

			section {
				margin-top: 60px;
			}

			#clearButton,
			#resetButton,
			#copyButton {
				margin-right: 10px;
				margin-bottom: 10px;
				padding: 10px 20px;
				font-size: 16px;
				cursor: pointer;
				background-color: #4CAF50;
				color: white;
				border: none;
				border-radius: 5px;
				transition: background-color 0.3s;
			}

			#clearButton:hover,
			#resetButton:hover,
			#copyButton:hover {
				background-color: #45a049;
			}

			#quickTextInput {
				padding: 5px;
				font-size: 16px;
			}

			#lowercaseButton, #titleCaseButton {
				margin-right: 10px;
				margin-bottom: 10px;
				padding: 10px 20px;
				font-size: 16px;
				cursor: pointer;
				background-color: #4CAF50;
				color: white;
				border: none;
				border-radius: 5px;
				transition: background-color 0.3s;
			}

			#lowercaseButton:hover, #titleCaseButton:hover {
				background-color: #45a049;
			}

			.manipulation-button {
				margin-right: 10px;
				margin-bottom: 10px;
				padding: 10px 20px;
				font-size: 16px;
				cursor: pointer;
				background-color: #4CAF50; /* Green background */
				color: white;
				border: none;
				border-radius: 5px;
				transition: background-color 0.3s;
			}

			.manipulation-button:hover {
				background-color: #45a049; /* Darker green on hover */
			}

			#quickTextInput {
				padding: 5px;
				font-size: 16px;
				width: 100%;
				margin-top: 10px;
				box-sizing: border-box;
			}
		</style>
	</head>
	<body>
		<h1>üåä Cumberland</h1>
		<p>This is a simple copyediting tool. Paste text below and errors will be highlighted according to rules. Updates will occur in realtime.</p>

		<section>

			<button id="clearButton">Clear Textarea</button>
			<button id="resetButton">Reset to Initial Content</button>
			<button id="copyButton">Copy to Clipboard</button>
			
			<textarea class="highlight-example">
===========================
Level 1 - Must be corrected
===========================

Phone number format: 123-456-7890 is correct. (123) 456-7890 is incorrect. 123.456.7890 is incorrect.

Date format: August 31 is correct. Oct. 31 is incorrect. Sept 15th is incorrect. June 7th is incorrect.

Time format: 11:30 a.m. is correct. 8:00 AM is incorrect. 9:20pm is incorrect. 7:15 pm is incorrect.

Ampersands: Any & character should match. & & &

Hash symbols: Any # character should match. # # #

"No." abbreviation: Any "no." abbreviation should match. no. 1 should match. no. 123 should match.

"Click here" phrase: Any "click here" phrase should match. click here should match. Click Here should match.

=============================
Level 2 - Recommended changes
=============================

Double spaces: This  has  multiple   spaces   in   it. Any double spaces should match.

Bullet points: Lines beginning with a bullet point should match, including following spaces. Example:
‚Ä¢ Bullet point with spaces
‚Ä¢Another bullet without space

URLs: https://www.example.com should match. http://subdomain.example.co.uk/page?param=value should match.

Roadway abbreviations: Rd, Ave, St, Pk, Pkwy, Blvd, and Wy should match. Avenue should not match.

==============================
Level 3 - Optional corrections
==============================

Trailing spaces: Trailing space characters at the end of lines should match. 

Curly quotes: Any curly quotes should match. ‚ÄúCurly quotes‚Äù and ‚ÄòSingle curly quotes‚Äô should match.

===============================
Level 4 - Require manual review
===============================

Acronyms: Any acronyms should match. NASA mission should match. FBI and CIA should match.
Words in ALL CAPS will also MATCH according to the acronym rule.
</textarea>
			
			<!-- New text manipulation section -->
			<div style="margin-top: 20px;">
				<h3>Quick Text Manipulations</h3>
				<button id="lowercaseButton" class="manipulation-button">Lowercase</button>
				<button id="titleCaseButton" class="manipulation-button">Title Case</button>
				<button id="removeSpacesButton" class="manipulation-button">Remove Extra Spaces</button>
				<button id="removeBulletsButton" class="manipulation-button">Remove Bullets and Leading Spaces</button>
				<br>
				<input type="text" id="quickTextInput" style="width: 100%; margin-top: 10px;" placeholder="Paste text here for quick manipulations">
			</div>

			<script>
				// Store the initial content
				const initialContent = document.querySelector('.highlight-example').value;

				// Clear button functionality
				document.getElementById('clearButton').addEventListener('click', function() {
					document.querySelector('.highlight-example').value = '';
					$('.highlight-example').trigger('input'); // Trigger highlighting
				});

				// Reset button functionality
				document.getElementById('resetButton').addEventListener('click', function() {
					document.querySelector('.highlight-example').value = initialContent;
					$('.highlight-example').trigger('input'); // Trigger highlighting
				});

				// Copy button functionality (unchanged)
				document.getElementById('copyButton').addEventListener('click', function() {
					var textarea = document.querySelector('.highlight-example');
					textarea.select();
					navigator.clipboard.writeText(textarea.value)
						.then(() => {
							this.textContent = 'Copied!';
							setTimeout(() => {
								this.textContent = 'Copy to Clipboard';
							}, 2000);
						})
						.catch(err => {
							console.error('Failed to copy text: ', err);
							this.textContent = 'Copy Failed';
							setTimeout(() => {
								this.textContent = 'Copy to Clipboard';
							}, 2000);
						});
				});

				// Highlighting rules (unchanged)
				$('.highlight-example').highlightWithinTextarea({
					highlight: [
						{
							highlight: /(\()?\d{3}((\))|(\.)|\s)?\s*\d{3}(\.|-)?\s*\d{4}(?!-)/g,
							className: 'red'
						},
						{
							highlight: /\b(?!(January|February|March|April|May|June|July|August|September|October|November|December)\s\d{1,2}(,\s\d{4})?\b)((Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Sept|Oct|Nov|Dec|January|February|March|April|June|July|August|September|October|November|December)\.?\s\d{1,2}(?:st|nd|rd|th)?(?!,\s\d{4}))(?!\s*[ap]\.m\.)\b/gi,
							className: 'red'
						},
						{
							highlight: /&/g,
							className: 'red'
						},
						{
							highlight: /#/g,
							className: 'red'
						},
						{
							highlight: /\bno\.\s*\d+\b/gi,
							className: 'red'
						},
						{
							highlight: /\b(?:1[0-2]|0?[1-9]):[0-5][0-9](?:\s*(?:AM|PM|A\.M\.|P\.M\.)|[ap]\.?m\.?(?!\.)|\s+[ap]m|\s+[AP]M)\b/g,
							className: 'red'
						},
						{
							highlight: /\bclick here\b/gi,
							className: 'red'
						},
						{
							highlight: /[^\S\r\n]{2,}(?!$)/gm,
							className: 'orange'
						},
						{
							highlight: /^[‚Ä¢]\s*/gm,
							className: 'orange'
						},
						{
							highlight: /https?:\/\/(?:www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b(?:[-a-zA-Z0-9()@:%_\+.~#?&//=]*)/g,
							className: 'orange'
						},
						{
							highlight: /[ \t]+$/gm,
							className: 'blue'
						},
						{
							highlight: /[‚Äú‚Äù‚Äò‚Äô]/g,
							className: 'blue'
						},
						{
							highlight: /\b[A-Z]{2,}\b/g,
							className: 'purple'
						},
						{
							highlight: /\b(?!\d{1,2}(:\d{2})? [ap]\.m\.)\d{1,2}(:\d{2})?\s*[ap]\.?m?\.?\b/gi,
							className: 'red'
						},
						
						// New rule for roadway abbreviations
						{
							highlight: /\b(Rd|Ave|St|Pk|Pkwy|Blvd|Wy)\b/g,
							className: 'orange'
						}
					]
				});

				// New script for text manipulations on the input field
				document.querySelectorAll('.manipulation-button').forEach(button => {
					button.addEventListener('click', function() {
						var input = document.getElementById('quickTextInput');
						switch(this.id) {
							case 'lowercaseButton':
								input.value = input.value.toLowerCase();
								break;
							case 'titleCaseButton':
								input.value = toTitleCase(input.value);
								break;
							case 'removeSpacesButton':
								input.value = input.value.replace(/\s+/g, ' ').trim();
								break;
							case 'removeBulletsButton':
								input.value = input.value.replace(/^[‚Ä¢\-\*\s]+/, '').trim();
								break;
						}
					});
				});

				// Title Case function
				function toTitleCase(str) {
					var smallWords = /^(a|an|and|as|at|but|by|en|for|if|in|of|on|or|the|to|vs?\.?|via)$/i;

					return str.replace(/[A-Za-z0-9\u00C0-\u00FF]+[^\s-]*/g, function(match, index, title) {
						if (index > 0 && index + match.length !== title.length &&
							match.search(smallWords) > -1 && title.charAt(index - 2) !== ":" &&
							(title.charAt(index + match.length) !== '-' || title.charAt(index - 1) === '-') &&
							title.charAt(index - 1).search(/[^\s-]/) < 0) {
							return match.toLowerCase();
						}

						if (match.substr(1).search(/[A-Z]|\../) > -1) {
							return match;
						}

						return match.charAt(0).toUpperCase() + match.substr(1);
					});
				}
			</script>
		</section>

	</body>
</html>